<Window x:Class="Synapse.Crypto.Patterns.ChartWnd"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:sp="clr-namespace:ScottPlot.WPF;assembly=ScottPlot.WPF"
        xmlns:bb="clr-namespace:Synapse.Crypto.Bybit;assembly=Synapse.Crypto.Bybit"
        xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
        xmlns:local="clr-namespace:Synapse.Crypto.Patterns"
        DataContext="{Binding RelativeSource={RelativeSource Mode=Self}}"
        mc:Ignorable="d"
        Title="{Binding RelativeSource={RelativeSource Mode=Self}, Path=Symbol}" 
        Height="450" Width="800" 
        Loaded="Window_Loaded" 
        Unloaded="Window_Unloaded">
    <Window.Resources>
        
        <ObjectDataProvider x:Key="timeFrames" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="bb:TimeFrames"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <ObjectDataProvider x:Key="chartTypes" MethodName="GetValues" ObjectType="{x:Type sys:Enum}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="local:ChartTypes"/>
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>

        <Style x:Key="ToolTextBlockStyle" TargetType="TextBlock">
            <Setter Property="Margin" Value="10,2,2,2"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="Blue"/>
        </Style>

    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="2*"/>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid x:Name="chartGrid" HorizontalAlignment="Stretch" Cursor="">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <ToolBar>
                
                <TextBlock Text="Bars" Style="{StaticResource ToolTextBlockStyle}"/>
                <xctk:IntegerUpDown Value="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=LoadedBars}"
                    Width="50" Minimum="48" Margin="2" ToolTip="Количество баров на графике"/>

                <TextBlock Text="Time frame" Style="{StaticResource ToolTextBlockStyle}" />
                <ComboBox Margin="2" Width="80" ItemsSource="{Binding Source={StaticResource timeFrames}}"
                      SelectedItem="{Binding TimeFrame}"/>

                <TextBlock Text="Chart type" Style="{StaticResource ToolTextBlockStyle}" />
                <ComboBox Margin="2" Width="100" ItemsSource="{Binding Source={StaticResource chartTypes}}"
                      SelectedItem="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ChartType}"/>
                
                <Separator/>
                
                <!--<ToggleButton Content="DHL" IsChecked="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=HighLowLine}"
                              Margin="2" ToolTip="Максимум/минимум предыдущего дня"/>-->

                <Menu >
                    <MenuItem Header="Range">
                        <MenuItem Header="One day" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="One" />
                        <MenuItem Header="Three days" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Three"/>
                        <MenuItem Header="Week" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Week"/>
                        <MenuItem Header="Month" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Month"/>
                        <Separator/>
                        <MenuItem Header="Clear" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Clear" />
                    </MenuItem>
                </Menu>
                
                <!--<xctk:SplitButton Content="Range" Margin="5,2">
                    <xctk:SplitButton.DropDownContent>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Button Content="One day" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="One" Margin="5"/>
                            <Button Grid.Row="1" Content="Three days" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Three" Margin="5"/>
                            <Button Grid.Row="2" Content="Week" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Week" Margin="5"/>
                            <Button Grid.Row="3" Content="Month" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Month" Margin="5"/>
                            <Button Grid.Row="4" Content="Clear" Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=RangeCommand}"
                                    CommandParameter="Clear" Margin="5"/>
                        </Grid>
                    </xctk:SplitButton.DropDownContent>
                </xctk:SplitButton>-->
                
                
                
            </ToolBar>
            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                <local:CandleView VerticalAlignment="Center" DataContext="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=CandleViewModel}"/>
            </StackPanel>
            <sp:WpfPlot Grid.Row="2" Name="Plot"/>

        </Grid>
        <GridSplitter Grid.Column="1" VerticalAlignment="Stretch" HorizontalAlignment="Center" Width="5" Background="Gray"/>
        <Grid x:Name="infoGrid" Grid.Column="2" HorizontalAlignment="Stretch">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <xctk:PropertyGrid x:Name="summaryPropGrid"
                    Grid.Row="0"
                    ShowAdvancedOptions="False"
                    ShowSearchBox="False"
                    ShowTitle="True"
                    ShowSortOptions="False"
                    IsMiscCategoryLabelHidden="True"
                    SelectedObject="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=ScreenItem}" >
                    <xctk:PropertyGrid.EditorDefinitions>
                        <xctk:EditorTemplateDefinition >
                        <xctk:EditorTemplateDefinition.TargetProperties>
                            <sys:String>HighBreakTime</sys:String>
                            <sys:String>HighRetestTime</sys:String>
                            <sys:String>LowBreakTime</sys:String>
                            <sys:String>LowRetestTime</sys:String>
                        </xctk:EditorTemplateDefinition.TargetProperties>
                        <xctk:EditorTemplateDefinition.EditingTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding Value, StringFormat={}{0:dd.MM.yy HH:mm}}" Foreground="Gray" />
                                </DataTemplate>
                            </xctk:EditorTemplateDefinition.EditingTemplate>
                        </xctk:EditorTemplateDefinition>

                    </xctk:PropertyGrid.EditorDefinitions>
                </xctk:PropertyGrid>
            
        </Grid>
    </Grid>
</Window>



<!--<xctk:EditorTemplateDefinition>
    <xctk:EditorTemplateDefinition.TargetProperties>
        <xctk:TargetPropertyType Type="{x:Type sys:DateTime}"  />
    </xctk:EditorTemplateDefinition.TargetProperties>
    <xctk:EditorTemplateDefinition.EditingTemplate>
        <DataTemplate>
            <StackPanel>
                <xctk:DateTimeUpDown
                        x:Name="DateTimeUpDown"
                        Margin="0,1"
                        Format="Custom" FormatString="dd/MM/yyyy HH:mm:ss"
                        Value="{Binding Value}" />
            </StackPanel>
        </DataTemplate>
    </xctk:EditorTemplateDefinition.EditingTemplate>
</xctk:EditorTemplateDefinition>-->